# Building Dogebox

## SD and SD installer images

These are built with FriendlyElec's sd-fuse_rk3588. Documentation TBA.

## Container/VM images

Quick notes on building a container or VM image from a configuration.nix file:

- Make sure the configuration.nix doesn't mention a bootloader, an appropriate one is included automatically and one defined here can conflict.

- Install `nixos-generators`, if you have the nix package manager or are running NixOS you can just run 'nix-shell -p nixos-generators'

- Build the desired image with `nixos-generate -c configuration.nix -f $format`

Tested image formats include: `docker`, `install-iso`, `iso`, `lxc`, `lxc-metadata`, `proxmox-lxc`, `qcow`, `vmware`

- The build output should tell you the name and location of the built image.

### 'docker' for docker/podman

Use `docker import` or 'podman import' to generate a container image. You will need to manually specify a run CMD.

### 'install-iso / iso' for optical media images

Generates a bootable iso, `install-iso` will give you an installer, `iso` will be a live CD.

### 'lxc / lxc-metadata, proxmox-lxc' for linux containers

Use `lxc` and `lxc-metadata` for a manual container, or load the file generated by `proxmox-lxc` as a CT template to generate a container in proxmox.

### 'qcow' for qemu qcow2

Can be used as a disk image for qemu.

### 'vmware' for VMWare and VirtualBox

Generates a VMDK file that can be used by VMware or VirtualBox VMs directly

If you'd prefer a VDI, you can convert with `VBoxManage clonehd --format VDI <from>.vmdk <to>.vdi`

Generating a VDI out of the box with `-f virtualbox` doesn't appear to be working currently with the default config.
